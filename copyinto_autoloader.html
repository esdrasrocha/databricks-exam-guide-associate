<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COPY INTO vs Auto Loader - A Verdade</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 40px;
            font-size: 18px;
        }
        
        .legacy-warning {
            background: linear-gradient(135deg, #f56565 0%, #c53030 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .legacy-warning h2 {
            margin-top: 0;
            font-size: 28px;
        }
        
        .section {
            background: #f7fafc;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            border-left: 5px solid #4299e1;
        }
        .section-title {
            font-size: 22px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        .comparison-table thead {
            background: linear-gradient(135deg, #4299e1 0%, #2c5282 100%);
            color: white;
        }
        .comparison-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        .comparison-table tr:hover {
            background: #f7fafc;
        }
        
        .vs-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .card h3 {
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .copyinto-card {
            border: 3px solid #ecc94b;
            background: linear-gradient(135deg, #fefcbf 0%, #faf089 100%);
        }
        .autoloader-card {
            border: 3px solid #48bb78;
            background: linear-gradient(135deg, #c6f6d5 0%, #9ae6b4 100%);
        }
        
        pre {
            background: #1a202c;
            color: #68d391;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 13px;
            line-height: 1.5;
            margin: 15px 0;
        }
        
        .scenario {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #805ad5;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .scenario h4 {
            color: #553c9a;
            margin-top: 0;
        }
        
        .winner {
            background: #c6f6d5;
            border-left: 4px solid #38a169;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .loser {
            background: #fed7d7;
            border-left: 4px solid #e53e3e;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        .neutral {
            background: #fef5e7;
            border-left: 4px solid #f39c12;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        .exam-tip {
            background: #ebf8ff;
            border-left: 4px solid #3182ce;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .exam-tip strong {
            color: #2c5282;
        }
        
        .pro-con {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        .pro {
            background: #f0fff4;
            border-left: 3px solid #48bb78;
            padding: 15px;
            border-radius: 5px;
        }
        .con {
            background: #fff5f5;
            border-left: 3px solid #f56565;
            padding: 15px;
            border-radius: 5px;
        }
        
        .highlight {
            background: #fef5e7;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #c05621;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .feature-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #4299e1;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .feature-box h5 {
            margin: 0 0 10px 0;
            color: #2c5282;
        }
        
        .timeline {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .timeline-item {
            display: flex;
            align-items: start;
            gap: 15px;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #4299e1;
        }
        .timeline-year {
            font-size: 24px;
            font-weight: bold;
            color: #2c5282;
            min-width: 80px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö†Ô∏è COPY INTO vs Auto Loader</h1>
        <p class="subtitle">Por que COPY INTO est√° virando legacy e quando usar cada um</p>

        <!-- Legacy Warning -->
        <div class="legacy-warning">
            <h2>üö® Por que COPY INTO est√° virando LEGACY?</h2>
            <div style="font-size: 16px; line-height: 1.8; margin-top: 15px;">
                <p><strong>COPY INTO n√£o est√° oficialmente "deprecated"</strong>, mas Databricks est√° <strong>ativamente desencorajando seu uso</strong> em favor do Auto Loader.</p>
                
                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <strong>üìä Evid√™ncias:</strong>
                    <ul style="line-height: 2; margin: 10px 0;">
                        <li>‚úÖ Documenta√ß√£o oficial recomenda Auto Loader como "best practice"</li>
                        <li>‚úÖ Auto Loader tem features que COPY INTO nunca ter√°</li>
                        <li>‚úÖ Performance do Auto Loader √© superior em quase todos os cen√°rios</li>
                        <li>‚úÖ Na prova DE Associate, Auto Loader √© a resposta preferida</li>
                        <li>‚úÖ Databricks investe em melhorias apenas no Auto Loader</li>
                    </ul>
                </div>

                <p style="font-size: 18px; margin-top: 20px;"><strong>‚ö° Mensagem do Databricks:</strong><br>
                "COPY INTO √© √∫til para casos espec√≠ficos, mas <span style="background: rgba(255,255,255,0.3); padding: 3px 8px; border-radius: 4px;">Auto Loader √© a solu√ß√£o moderna e recomendada</span> para ingest√£o de arquivos."</p>
            </div>
        </div>

        <!-- Evolution Timeline -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">üìÖ</span>
                Linha do Tempo: A Evolu√ß√£o da Ingest√£o no Databricks
            </div>
            
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-year">2016-2018</div>
                    <div>
                        <strong>Notebooks + spark.read()</strong><br>
                        <span style="color: #718096;">Ingest√£o manual com c√≥digo Python/Scala. Nada automatizado.</span>
                    </div>
                </div>
                
                <div class="timeline-item">
                    <div class="timeline-year">2019</div>
                    <div>
                        <strong>COPY INTO lan√ßado</strong><br>
                        <span style="color: #718096;">SQL simples para ingest√£o batch com idempot√™ncia. Grande avan√ßo na √©poca!</span>
                    </div>
                </div>
                
                <div class="timeline-item" style="border-left-color: #48bb78;">
                    <div class="timeline-year">2020</div>
                    <div>
                        <strong>üöÄ Auto Loader lan√ßado</strong><br>
                        <span style="color: #2f855a;"><strong>Game changer!</strong> Streaming, schema evolution, file notification service.</span>
                    </div>
                </div>
                
                <div class="timeline-item" style="border-left-color: #48bb78;">
                    <div class="timeline-year">2021-2025</div>
                    <div>
                        <strong>Auto Loader domina</strong><br>
                        <span style="color: #2f855a;">Melhorias cont√≠nuas, se torna a recomenda√ß√£o oficial. COPY INTO entra em "maintenance mode".</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comparison Table -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">‚öñÔ∏è</span>
                Compara√ß√£o Detalhada
            </div>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Caracter√≠stica</th>
                        <th>COPY INTO</th>
                        <th>Auto Loader</th>
                        <th>Vencedor</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Tipo de Processamento</strong></td>
                        <td>Batch (execu√ß√£o pontual)</td>
                        <td>Streaming (cont√≠nuo)</td>
                        <td>üèÜ Auto Loader (mais moderno)</td>
                    </tr>
                    <tr>
                        <td><strong>Idempot√™ncia</strong></td>
                        <td>‚úÖ Sim (rastreia arquivos processados)</td>
                        <td>‚úÖ Sim (checkpoint)</td>
                        <td>ü§ù Empate</td>
                    </tr>
                    <tr>
                        <td><strong>Schema Evolution</strong></td>
                        <td>‚ùå Manual (precisa especificar)</td>
                        <td>‚úÖ Autom√°tico (schema inference + evolution)</td>
                        <td>üèÜ Auto Loader</td>
                    </tr>
                    <tr>
                        <td><strong>Detec√ß√£o de Arquivos</strong></td>
                        <td>List files (lento em muitos arquivos)</td>
                        <td>File notification (S3 Events, Event Grid)</td>
                        <td>üèÜ Auto Loader</td>
                    </tr>
                    <tr>
                        <td><strong>Performance com milh√µes de arquivos</strong></td>
                        <td>‚ùå Degrada (precisa listar todos)</td>
                        <td>‚úÖ Excelente (notifica√ß√£o de eventos)</td>
                        <td>üèÜ Auto Loader</td>
                    </tr>
                    <tr>
                        <td><strong>Lat√™ncia</strong></td>
                        <td>Alta (batch agendado)</td>
                        <td>Baixa (near real-time)</td>
                        <td>üèÜ Auto Loader</td>
                    </tr>
                    <tr>
                        <td><strong>Simplicidade (c√≥digo)</strong></td>
                        <td>‚úÖ SQL simples (1-2 linhas)</td>
                        <td>Mais verboso (precisa configurar)</td>
                        <td>üèÜ COPY INTO</td>
                    </tr>
                    <tr>
                        <td><strong>Custo operacional</strong></td>
                        <td>M√©dio (re-scans desnecess√°rios)</td>
                        <td>Baixo (processa s√≥ o novo)</td>
                        <td>üèÜ Auto Loader</td>
                    </tr>
                    <tr>
                        <td><strong>Casos de uso</strong></td>
                        <td>Batch simples, poucos arquivos</td>
                        <td>Streaming, escala, produ√ß√£o</td>
                        <td>üèÜ Auto Loader (mais vers√°til)</td>
                    </tr>
                    <tr>
                        <td><strong>Recomenda√ß√£o Databricks</strong></td>
                        <td>‚ö†Ô∏è Casos espec√≠ficos</td>
                        <td>‚úÖ Best practice padr√£o</td>
                        <td>üèÜ Auto Loader</td>
                    </tr>
                </tbody>
            </table>

            <div class="exam-tip">
                <strong>üéØ PARA A PROVA:</strong> Se a pergunta n√£o especificar restri√ß√µes t√©cnicas, <strong>Auto Loader √© sempre a resposta correta</strong>. COPY INTO s√≥ √© correto quando a pergunta mencionar "batch simples" ou "SQL only".
            </div>
        </div>

        <!-- Detailed Comparison -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">üîç</span>
                Por que Auto Loader √© Superior?
            </div>
            
            <div class="features-grid">
                <div class="feature-box">
                    <h5>üöÄ Schema Inference</h5>
                    <p style="font-size: 13px; margin: 0;">Detecta automaticamente o schema dos arquivos sem voc√™ precisar definir</p>
                </div>
                
                <div class="feature-box">
                    <h5>üîÑ Schema Evolution</h5>
                    <p style="font-size: 13px; margin: 0;">Adiciona colunas novas automaticamente quando o schema muda</p>
                </div>
                
                <div class="feature-box">
                    <h5>‚ö° File Notification</h5>
                    <p style="font-size: 13px; margin: 0;">Usa eventos nativos da cloud (S3 Events) ao inv√©s de listar arquivos</p>
                </div>
                
                <div class="feature-box">
                    <h5>üìä Escalabilidade</h5>
                    <p style="font-size: 13px; margin: 0;">Performance constante mesmo com milh√µes de arquivos</p>
                </div>
                
                <div class="feature-box">
                    <h5>üîÅ Streaming</h5>
                    <p style="font-size: 13px; margin: 0;">Processa dados continuamente com baixa lat√™ncia</p>
                </div>
                
                <div class="feature-box">
                    <h5>üõ°Ô∏è Rescue Data</h5>
                    <p style="font-size: 13px; margin: 0;">Captura dados malformados em coluna especial (_rescued_data)</p>
                </div>
            </div>

            <h4 style="margin-top: 30px;">üìà Problema de Performance: COPY INTO com muitos arquivos</h4>
            
            <div class="vs-grid">
                <div class="card loser">
                    <h4 style="color: #c53030; margin-top: 0;">‚ùå COPY INTO - Degrada com escala</h4>
                    <pre style="font-size: 11px;">-- COPY INTO precisa listar TODOS os arquivos
-- mesmo os j√° processados
COPY INTO vendas
FROM '/data/vendas/'  -- 1 milh√£o de arquivos

-- Processo:
1. Lista todos 1 milh√£o de arquivos (lento!)
2. Verifica metadata de quais j√° processou
3. Processa s√≥ os novos
4. Na pr√≥xima execu√ß√£o: repete tudo!</pre>
                    <p style="color: #c53030; margin: 10px 0 0 0;">‚è±Ô∏è <strong>Tempo cresce linearmente com # de arquivos</strong></p>
                </div>

                <div class="card winner">
                    <h4 style="color: #2f855a; margin-top: 0;">‚úÖ Auto Loader - Escala infinitamente</h4>
                    <pre style="font-size: 11px;">-- Auto Loader usa notifica√ß√µes de eventos
df = spark.readStream \
    .format("cloudFiles") \
    .load("/data/vendas/")

-- Processo:
1. S3 envia notifica√ß√£o: "novo arquivo X"
2. Auto Loader processa s√≥ arquivo X
3. Nunca lista todos os arquivos!
4. Performance constante sempre!</pre>
                    <p style="color: #2f855a; margin: 10px 0 0 0;">‚ö° <strong>Tempo constante O(1) independente de # arquivos</strong></p>
                </div>
            </div>
        </div>

        <!-- Scenarios -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">üé¨</span>
                Cen√°rios Reais: Quando Usar Cada Um
            </div>

            <!-- Scenario 1 -->
            <div class="scenario">
                <h4>üì¶ Cen√°rio 1: Carga Di√°ria de Arquivos CSV</h4>
                <p><strong>Situa√ß√£o:</strong> Voc√™ recebe 10 arquivos CSV por dia em um bucket S3. Precisa processar esses arquivos.</p>
                
                <div class="vs-grid">
                    <div class="copyinto-card card">
                        <h3 style="color: #c05621;">‚ö†Ô∏è COPY INTO (Funciona, mas n√£o ideal)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #fbd38d;">-- Executar em job agendado (1x por dia)
COPY INTO bronze.vendas
FROM 's3://bucket/vendas/'
FILEFORMAT = CSV
FORMAT_OPTIONS ('header' = 'true')
COPY_OPTIONS ('mergeSchema' = 'true');</pre>
                        <div class="pro-con">
                            <div class="pro">
                                <strong>‚úÖ Pr√≥s:</strong>
                                <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                    <li>Simples (1 comando SQL)</li>
                                    <li>F√°cil de entender</li>
                                    <li>Bom para poucos arquivos</li>
                                </ul>
                            </div>
                            <div class="con">
                                <strong>‚ùå Contras:</strong>
                                <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                    <li>Batch (lat√™ncia de at√© 24h)</li>
                                    <li>Lista todos os arquivos</li>
                                    <li>Schema manual</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="autoloader-card card">
                        <h3 style="color: #2f855a;">üèÜ Auto Loader (MELHOR op√ß√£o)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #68d391;"># Streaming cont√≠nuo
df = spark.readStream \
    .format("cloudFiles") \
    .option("cloudFiles.format", "csv") \
    .option("cloudFiles.schemaLocation", "/schemas/") \
    .option("header", "true") \
    .load("s3://bucket/vendas/")

df.writeStream \
    .option("checkpointLocation", "/checkpoints/") \
    .table("bronze.vendas")</pre>
                        <div class="pro-con">
                            <div class="pro">
                                <strong>‚úÖ Pr√≥s:</strong>
                                <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                    <li>Processa imediatamente</li>
                                    <li>Schema autom√°tico</li>
                                    <li>Escala melhor</li>
                                    <li>Menor lat√™ncia</li>
                                </ul>
                            </div>
                            <div class="con">
                                <strong>‚ùå Contras:</strong>
                                <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                    <li>Mais c√≥digo</li>
                                    <li>Precisa entender streaming</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="winner">
                    <strong>üéØ VENCEDOR: Auto Loader</strong> - Mesmo com poucos arquivos, benef√≠cios superam complexidade
                </div>
            </div>

            <!-- Scenario 2 -->
            <div class="scenario">
                <h4>üöÄ Cen√°rio 2: Ingest√£o de Log Streaming (alta frequ√™ncia)</h4>
                <p><strong>Situa√ß√£o:</strong> Aplica√ß√£o gera arquivos JSON de log a cada 30 segundos no S3. Voc√™ precisa processar com lat√™ncia < 5 minutos.</p>
                
                <div class="vs-grid">
                    <div class="copyinto-card card">
                        <h3 style="color: #c05621;">‚ùå COPY INTO (N√ÉO FUNCIONA BEM)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #fbd38d;">-- Agendar para rodar a cada 5 min
COPY INTO bronze.logs
FROM 's3://bucket/logs/'
FILEFORMAT = JSON;</pre>
                        <div class="loser">
                            <strong>‚ùå PROBLEMAS:</strong>
                            <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                <li>Batch n√£o √© ideal para streaming</li>
                                <li>Overhead de listar arquivos a cada 5min</li>
                                <li>Lat√™ncia vari√°vel</li>
                                <li>Recursos desperdi√ßados</li>
                            </ul>
                        </div>
                    </div>

                    <div class="autoloader-card card">
                        <h3 style="color: #2f855a;">üèÜ Auto Loader (PERFEITO)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #68d391;"># Streaming cont√≠nuo - processa assim que chega
df = spark.readStream \
    .format("cloudFiles") \
    .option("cloudFiles.format", "json") \
    .option("cloudFiles.useNotifications", "true") \
    .load("s3://bucket/logs/")

df.writeStream \
    .trigger(processingTime="1 minute") \
    .table("bronze.logs")</pre>
                        <div class="winner">
                            <strong>‚úÖ VANTAGENS:</strong>
                            <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                <li>Lat√™ncia consistente (1-2 min)</li>
                                <li>Event-driven (S3 notifica)</li>
                                <li>Sem desperd√≠cio de recursos</li>
                                <li>Escala automaticamente</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="winner">
                    <strong>üéØ VENCEDOR CLARO: Auto Loader</strong> - COPY INTO n√£o √© adequado para streaming
                </div>
            </div>

            <!-- Scenario 3 -->
            <div class="scenario">
                <h4>üìä Cen√°rio 3: Carga Hist√≥rica √önica (One-time Backfill)</h4>
                <p><strong>Situa√ß√£o:</strong> Voc√™ tem 5TB de dados hist√≥ricos (100 arquivos grandes) que precisa carregar UMA VEZ APENAS.</p>
                
                <div class="vs-grid">
                    <div class="copyinto-card card">
                        <h3 style="color: #2f855a;">‚úÖ COPY INTO (ACEIT√ÅVEL)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #fbd38d;">-- Execu√ß√£o √∫nica
COPY INTO bronze.historico
FROM 's3://bucket/historical/'
FILEFORMAT = PARQUET;</pre>
                        <div class="winner">
                            <strong>‚úÖ VANTAGENS:</strong>
                            <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                <li>Simples para uso √∫nico</li>
                                <li>SQL puro</li>
                                <li>N√£o precisa configurar streaming</li>
                            </ul>
                        </div>
                    </div>

                    <div class="autoloader-card card">
                        <h3 style="color: #2f855a;">‚úÖ Auto Loader (TAMB√âM BOM)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #68d391;"># Trigger once = batch mode
df = spark.readStream \
    .format("cloudFiles") \
    .option("cloudFiles.format", "parquet") \
    .load("s3://bucket/historical/")

df.writeStream \
    .trigger(once=True) \  # ‚Üê Executa UMA VEZ
    .table("bronze.historico")</pre>
                        <div class="winner">
                            <strong>‚úÖ VANTAGENS:</strong>
                            <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                <li>Schema inference autom√°tico</li>
                                <li>Pode virar streaming depois</li>
                                <li>Melhor performance</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="neutral">
                    <strong>ü§ù EMPATE T√âCNICO</strong> - Ambos funcionam bem. COPY INTO √© mais simples, Auto Loader √© mais flex√≠vel.
                </div>
            </div>

            <!-- Scenario 4 -->
            <div class="scenario">
                <h4>üîÑ Cen√°rio 4: Milh√µes de Arquivos Pequenos</h4>
                <p><strong>Situa√ß√£o:</strong> Voc√™ tem 2 milh√µes de arquivos CSV pequenos (1MB cada) acumulados no S3. Precisa processar tudo.</p>
                
                <div class="vs-grid">
                    <div class="copyinto-card card">
                        <h3 style="color: #c53030;">‚ùå COPY INTO (VAI TRAVAR)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #fbd38d;">-- CUIDADO! Isso vai demorar HORAS
COPY INTO bronze.dados
FROM 's3://bucket/milhoes-arquivos/'
FILEFORMAT = CSV;</pre>
                        <div class="loser">
                            <strong>‚ùå PROBLEMAS GRAVES:</strong>
                            <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                <li>Precisa listar 2M arquivos (30+ min)</li>
                                <li>Usa muita mem√≥ria do driver</li>
                                <li>Pode dar timeout ou OOM</li>
                                <li>Performance horr√≠vel</li>
                            </ul>
                            <p style="color: #c53030; margin-top: 10px;"><strong>üö® N√ÉO USE COPY INTO NESTE CASO!</strong></p>
                        </div>
                    </div>

                    <div class="autoloader-card card">
                        <h3 style="color: #2f855a;">üèÜ Auto Loader (S√ì ELE FUNCIONA)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #68d391;"># File notification service
df = spark.readStream \
    .format("cloudFiles") \
    .option("cloudFiles.format", "csv") \
    .option("cloudFiles.useNotifications", "true") \
    .option("cloudFiles.maxFilesPerTrigger", 1000) \
    .load("s3://bucket/milhoes-arquivos/")

df.writeStream.table("bronze.dados")</pre>
                        <div class="winner">
                            <strong>‚úÖ POR QUE FUNCIONA:</strong>
                            <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                <li>Usa SQS/Event Grid (n√£o lista)</li>
                                <li>Processa em batches (1000/vez)</li>
                                <li>Mem√≥ria constante</li>
                                <li>Performance previs√≠vel</li>
                            </ul>
                            <p style="color: #2f855a; margin-top: 10px;"><strong>‚úÖ Processa milh√µes sem travar!</strong></p>
                        </div>
                    </div>
                </div>
                
                <div class="winner">
                    <strong>üéØ VENCEDOR ABSOLUTO: Auto Loader</strong> - COPY INTO simplesmente n√£o escala para isso
                </div>
            </div>

            <!-- Scenario 5 -->
            <div class="scenario">
                <h4>üéì Cen√°rio 5: Ambiente de Desenvolvimento/Teste</h4>
                <p><strong>Situa√ß√£o:</strong> Voc√™ est√° testando rapidamente com 5 arquivos CSV no desenvolvimento.</p>
                
                <div class="vs-grid">
                    <div class="copyinto-card card">
                        <h3 style="color: #2f855a;">‚úÖ COPY INTO (PERFEITO)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #fbd38d;">-- Quick & dirty para testar
COPY INTO dev.test_table
FROM '/tmp/test-files/'
FILEFORMAT = CSV
FORMAT_OPTIONS ('header' = 'true');</pre>
                        <div class="winner">
                            <strong>‚úÖ IDEAL PARA DEV:</strong>
                            <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                <li>Setup zero</li>
                                <li>Executa imediatamente</li>
                                <li>N√£o precisa checkpoint</li>
                                <li>F√°cil debug</li>
                            </ul>
                        </div>
                    </div>

                    <div class="autoloader-card card">
                        <h3 style="color: #c05621;">‚ö†Ô∏è Auto Loader (Overkill)</h3>
                        <pre style="font-size: 11px; background: #1a202c; color: #68d391;"># Muito setup para teste simples
df = spark.readStream \
    .format("cloudFiles") \
    .option("cloudFiles.format", "csv") \
    .option("cloudFiles.schemaLocation", "...") \
    .load("/tmp/test-files/")

df.writeStream \
    .option("checkpointLocation", "...") \
    .table("dev.test_table")</pre>
                        <div class="con">
                            <strong>‚ùå OVERKILL:</strong>
                            <ul style="margin: 5px 0; padding-left: 20px; font-size: 13px;">
                                <li>Precisa configurar schemas</li>
                                <li>Precisa checkpoints</li>
                                <li>Mais complexo para teste</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="winner">
                    <strong>üéØ VENCEDOR: COPY INTO</strong> - Para testes r√°pidos, simplicidade vence
                </div>
            </div>
        </div>

        <!-- Summary Table -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">üìä</span>
                Resumo: Quando Usar Cada Um
            </div>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Cen√°rio</th>
                        <th>COPY INTO</th>
                        <th>Auto Loader</th>
                        <th>Recomenda√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Poucos arquivos, batch di√°rio</td>
                        <td>‚úÖ Funciona</td>
                        <td>‚úÖ‚úÖ Melhor</td>
                        <td>Auto Loader</td>
                    </tr>
                    <tr>
                        <td>Streaming / Alta frequ√™ncia</td>
                        <td>‚ùå Inadequado</td>
                        <td>‚úÖ‚úÖ‚úÖ Perfeito</td>
                        <td>Auto Loader</td>
                    </tr>
                    <tr>
                        <td>Carga hist√≥rica √∫nica (100 arquivos)</td>
                        <td>‚úÖ Aceit√°vel</td>
                        <td>‚úÖ Aceit√°vel</td>
                        <td>Empate (COPY INTO mais simples)</td>
                    </tr>
                    <tr>
                        <td>Milh√µes de arquivos</td>
                        <td>‚ùå‚ùå N√£o use!</td>
                        <td>‚úÖ‚úÖ‚úÖ √önico que funciona</td>
                        <td>Auto Loader</td>
                    </tr>
                    <tr>
                        <td>Schema evolui frequentemente</td>
                        <td>‚ùå Manual</td>
                        <td>‚úÖ‚úÖ Autom√°tico</td>
                        <td>Auto Loader</td>
                    </tr>
                    <tr>
                        <td>Testes r√°pidos (dev)</td>
                        <td>‚úÖ‚úÖ √ìtimo</td>
                        <td>‚ö†Ô∏è Complexo demais</td>
                        <td>COPY INTO</td>
                    </tr>
                    <tr>
                        <td>Produ√ß√£o / Escala</td>
                        <td>‚ö†Ô∏è Limitado</td>
                        <td>‚úÖ‚úÖ‚úÖ Recomendado</td>
                        <td>Auto Loader</td>
                    </tr>
                    <tr>
                        <td>Analista SQL (sem Python)</td>
                        <td>‚úÖ‚úÖ F√°cil</td>
                        <td>‚ùå Precisa Python/Scala</td>
                        <td>COPY INTO</td>
                    </tr>
                    <tr>
                        <td>Baixa lat√™ncia (< 5 min)</td>
                        <td>‚ùå Batch</td>
                        <td>‚úÖ‚úÖ Streaming</td>
                        <td>Auto Loader</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Why Legacy -->
        <div class="section" style="background: #fff5f5; border-left-color: #f56565;">
            <div class="section-title" style="color: #c53030;">
                <span style="font-size: 28px;">‚ö†Ô∏è</span>
                Por que COPY INTO est√° virando Legacy?
            </div>
            
            <div style="display: grid; gap: 20px; margin-top: 20px;">
                <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid #f56565;">
                    <h4 style="color: #c53030; margin-top: 0;">1. Limita√ß√µes T√©cnicas Intranspon√≠veis</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Arquitetura batch</strong> - n√£o pode ser streaming</li>
                        <li><strong>Lista todos arquivos</strong> - n√£o escala para milh√µes</li>
                        <li><strong>Sem schema evolution</strong> - precisa recriar tabela</li>
                        <li><strong>Sem rescue data</strong> - perde dados malformados</li>
                    </ul>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid #f56565;">
                    <h4 style="color: #c53030; margin-top: 0;">2. Auto Loader Faz Tudo que COPY INTO Faz + Muito Mais</h4>
                    <ul style="line-height: 1.8;">
                        <li>Auto Loader pode rodar em modo batch (<code>trigger(once=True)</code>)</li>
                        <li>Auto Loader tem melhor performance at√© em batch</li>
                        <li>Qualquer use case de COPY INTO, Auto Loader faz melhor</li>
                    </ul>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid #f56565;">
                    <h4 style="color: #c53030; margin-top: 0;">3. Databricks Parou de Investir em COPY INTO</h4>
                    <ul style="line-height: 1.8;">
                        <li>Sem novas features desde 2020</li>
                        <li>Documenta√ß√£o promove Auto Loader</li>
                        <li>Certifica√ß√µes focam em Auto Loader</li>
                        <li>Suporte m√≠nimo (maintenance mode)</li>
                    </ul>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid #f56565;">
                    <h4 style="color: #c53030; margin-top: 0;">4. Tend√™ncia da Ind√∫stria: Streaming-First</h4>
                    <ul style="line-height: 1.8;">
                        <li>Modern data platforms s√£o streaming-first</li>
                        <li>Batch est√° virando "streaming lento"</li>
                        <li>Real-time √© o novo normal</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Exam Strategy -->
        <div class="section" style="background: linear-gradient(135deg, #4299e1 0%, #2c5282 100%); color: white; border: none;">
            <div class="section-title" style="color: white;">
                <span style="font-size: 28px;">üéì</span>
                Estrat√©gia para a Prova DE Associate
            </div>
            
            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 10px; margin-top: 20px;">
                <h3 style="color: white; margin-top: 0;">üéØ Regras de Ouro</h3>
                <div style="font-size: 16px; line-height: 2;">
                    <p><strong>1. Quando a pergunta diz "qual a melhor pr√°tica?"</strong><br>
                    ‚Üí <span class="highlight" style="color: #1a202c;">SEMPRE Auto Loader</span></p>

                    <p><strong>2. Quando a pergunta diz "solu√ß√£o mais simples para..."</strong><br>
                    ‚Üí <span class="highlight" style="color: #1a202c;">Pode ser COPY INTO se for caso trivial</span></p>

                    <p><strong>3. Quando menciona "streaming", "real-time", "lat√™ncia baixa"</strong><br>
                    ‚Üí <span class="highlight" style="color: #1a202c;">SEMPRE Auto Loader</span></p>

                    <p><strong>4. Quando menciona "milh√µes de arquivos", "escala"</strong><br>
                    ‚Üí <span class="highlight" style="color: #1a202c;">SEMPRE Auto Loader</span></p>

                    <p><strong>5. Quando menciona "schema evolui"</strong><br>
                    ‚Üí <span class="highlight" style="color: #1a202c;">SEMPRE Auto Loader</span></p>

                    <p><strong>6. Quando menciona "teste r√°pido", "ad-hoc", "poucos arquivos"</strong><br>
                    ‚Üí <span class="highlight" style="color: #1a202c;">COPY INTO √© aceit√°vel</span></p>
                </div>
            </div>

            <div class="exam-tip" style="background: rgba(255,255,255,0.15); margin-top: 20px;">
                <strong style="color: white; font-size: 18px;">‚ö° DICA DE OURO:</strong><br>
                <p style="color: white; margin-top: 10px; font-size: 16px;">
                Na d√∫vida entre COPY INTO e Auto Loader? <strong>Escolha Auto Loader</strong>.<br>
                Databricks quer promover Auto Loader como o padr√£o moderno.<br>
                COPY INTO s√≥ √© correto quando a pergunta CLARAMENTE indica um caso simples/espec√≠fico.
                </p>
            </div>
        </div>

        <!-- Final Decision Matrix -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">‚úÖ</span>
                Matriz de Decis√£o Final
            </div>
            
            <div style="background: white; padding: 25px; border-radius: 10px; margin-top: 20px;">
                <h3 style="margin-top: 0;">Use COPY INTO apenas quando:</h3>
                <ul style="line-height: 2; font-size: 16px;">
                    <li>‚úÖ Ambiente de desenvolvimento/teste</li>
                    <li>‚úÖ Carga one-time de poucos arquivos (&lt; 100)</li>
                    <li>‚úÖ Equipe s√≥ conhece SQL (sem Python/Scala)</li>
                    <li>‚úÖ Prototipagem r√°pida</li>
                </ul>

                <h3 style="margin-top: 30px;">Use Auto Loader para:</h3>
                <ul style="line-height: 2; font-size: 16px;">
                    <li>‚úÖ‚úÖ‚úÖ <strong>QUALQUER AMBIENTE DE PRODU√á√ÉO</strong></li>
                    <li>‚úÖ‚úÖ‚úÖ <strong>Streaming / Real-time</strong></li>
                    <li>‚úÖ‚úÖ‚úÖ <strong>Grande escala (1000+ arquivos)</strong></li>
                    <li>‚úÖ‚úÖ‚úÖ <strong>Schema evolui</strong></li>
                    <li>‚úÖ‚úÖ‚úÖ <strong>Performance cr√≠tica</strong></li>
                    <li>‚úÖ‚úÖ‚úÖ <strong>Quando a prova perguntar "best practice"</strong></li>
                </ul>

                <div style="background: #c6f6d5; border-left: 4px solid #38a169; padding: 20px; margin-top: 30px; border-radius: 8px;">
                    <p style="margin: 0; font-size: 18px; font-weight: 600; color: #2f855a;">
                        üí° REGRA DEFINITIVA: "Quando em d√∫vida, Auto Loader"
                    </p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
