<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Databricks: O que REALMENTE Querem que Voc√™ Saiba</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 40px;
            font-size: 18px;
        }
        
        .myth-buster {
            background: #fff5f5;
            border-left: 5px solid #f56565;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .myth-buster h3 {
            color: #c53030;
            margin-top: 0;
        }
        
        .truth {
            background: #f0fff4;
            border-left: 5px solid #48bb78;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .truth h3 {
            color: #2f855a;
            margin-top: 0;
        }
        
        .section {
            background: #f7fafc;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            border-left: 5px solid #4299e1;
        }
        .section-title {
            font-size: 22px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .card h4 {
            margin-top: 0;
            color: #2d3748;
        }
        
        .old-way {
            border-left: 4px solid #e53e3e;
        }
        .new-way {
            border-left: 4px solid #38a169;
        }
        
        pre {
            background: #1a202c;
            color: #68d391;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 13px;
            line-height: 1.5;
        }
        
        .warning {
            background: #fef5e7;
            border-left: 4px solid #f39c12;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .exam-tip {
            background: #ebf8ff;
            border-left: 4px solid #3182ce;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .exam-tip strong {
            color: #2c5282;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        th {
            background: #4299e1;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        tr:hover {
            background: #f7fafc;
        }
        
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .feature-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #4299e1;
        }
        
        .highlight {
            background: #fef5e7;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ O que Databricks QUER que voc√™ saiba na prova</h1>
        <p class="subtitle">Entendendo CTAS, Volumes, DLT, Data Quality e a vis√£o do Databricks</p>

        <!-- CTAS Clarification -->
        <div class="myth-buster">
            <h3>‚ùå MITO: "CTAS precisa de Volumes"</h3>
            <p><strong>FALSO!</strong> CTAS trabalha com qualquer tabela j√° no Databricks (Delta Lake, tabelas no Unity Catalog).</p>
            <p><strong>CTAS = Create Table As Select</strong> ‚Üí cria uma tabela a partir de uma <strong>query SQL</strong> de dados que j√° est√£o no lakehouse.</p>
        </div>

        <div class="truth">
            <h3>‚úÖ VERDADE sobre CTAS</h3>
            <pre>-- CTAS N√ÉO precisa de Volumes!
-- Exemplo 1: Criar tabela a partir de outra tabela
CREATE TABLE gold.vendas_mes AS
SELECT 
    ano,
    mes,
    produto,
    SUM(valor) as total_vendas
FROM silver.vendas
GROUP BY ano, mes, produto;

-- Exemplo 2: Criar tabela agregada
CREATE TABLE gold.clientes_ativos AS
SELECT * FROM silver.clientes
WHERE status = 'Ativo';</pre>
            <p><strong>CTAS trabalha com:</strong></p>
            <ul>
                <li>‚úÖ Tabelas Delta no Unity Catalog</li>
                <li>‚úÖ Views</li>
                <li>‚úÖ Queries complexas com JOINs</li>
                <li>‚úÖ Dados j√° ingeridos (Bronze/Silver)</li>
                <li>‚ùå N√ÉO l√™ arquivos externos diretamente (use Auto Loader/COPY INTO primeiro)</li>
            </ul>
        </div>

        <!-- Volumes vs Tables -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">üì¶</span>
                Volumes vs Tabelas - Quando usar cada um?
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>Conceito</th>
                        <th>O que √©?</th>
                        <th>Quando usar?</th>
                        <th>Exemplos</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Volumes</strong></td>
                        <td>Armazenamento de arquivos n√£o estruturados no Unity Catalog</td>
                        <td>Armazenar arquivos brutos (CSV, JSON, imagens, modelos ML)</td>
                        <td>/Volumes/catalog/schema/volume_raw/<br>Arquivos de input, checkpoints, modelos</td>
                    </tr>
                    <tr>
                        <td><strong>Tabelas Delta</strong></td>
                        <td>Dados estruturados/semi-estruturados em formato Delta</td>
                        <td>Dados prontos para query e analytics</td>
                        <td>bronze.clientes<br>silver.vendas<br>gold.metricas</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning">
                <strong>üéØ Para a prova:</strong><br>
                ‚Ä¢ <strong>Volumes</strong> = file system gerenciado (pense em S3/ADLS mas no Unity Catalog)<br>
                ‚Ä¢ <strong>Tabelas</strong> = dados estruturados consult√°veis via SQL<br>
                ‚Ä¢ <strong>CTAS</strong> cria Tabelas, n√£o Volumes!
            </div>
        </div>

        <!-- The Databricks Way -->
        <div class="section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
            <div class="section-title" style="color: white;">
                <span style="font-size: 28px;">üéØ</span>
                O QUE DATABRICKS QUER PROMOVER (foco da prova!)
            </div>
            
            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="color: white; margin-top: 0;">üöÄ Vis√£o do Databricks: Lakehouse Platform All-in-One</h3>
                <p style="font-size: 16px; line-height: 1.8;">
                    Databricks quer que voc√™ <strong>ABANDONE</strong> ferramentas externas como:<br>
                    ‚ùå Azure Data Factory (ADF)<br>
                    ‚ùå Airflow<br>
                    ‚ùå Fivetran<br>
                    ‚ùå dbt (parcialmente)<br><br>
                    
                    E use as ferramentas <strong>NATIVAS</strong> deles:<br>
                    ‚úÖ <strong>Lakeflow Connect</strong> ‚Üí ingest√£o (substitui ADF/Fivetran)<br>
                    ‚úÖ <strong>Lakeflow Jobs/Workflows</strong> ‚Üí orquestra√ß√£o (substitui Airflow)<br>
                    ‚úÖ <strong>Delta Live Tables (DLT)</strong> ‚Üí pipelines declarativos (substitui dbt + notebooks complexos)<br>
                    ‚úÖ <strong>Unity Catalog</strong> ‚Üí governan√ßa centralizada<br>
                    ‚úÖ <strong>Databricks SQL</strong> ‚Üí analytics + BI
                </p>
            </div>
        </div>

        <!-- Your Company vs Databricks Way -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">üè¢</span>
                Sua Empresa vs O Que Databricks Quer
            </div>
            
            <div class="comparison-grid">
                <div class="card old-way">
                    <h4>‚ùå Seu Setup Atual (Old Way)</h4>
                    <ul>
                        <li><strong>Ingest√£o:</strong> Azure Data Factory (ADF)</li>
                        <li><strong>Bronze:</strong> ADF escreve no Unity Catalog</li>
                        <li><strong>Silver/Gold:</strong> Notebooks Python/PySpark</li>
                        <li><strong>Orquestra√ß√£o:</strong> ADF ou clusters ad-hoc</li>
                        <li><strong>Qualidade:</strong> Valida√ß√µes customizadas</li>
                    </ul>
                    <p style="color: #c53030; font-weight: 600;">
                        ‚ö†Ô∏è Databricks considera isso "fragmentado" e dif√≠cil de manter
                    </p>
                </div>

                <div class="card new-way">
                    <h4>‚úÖ Databricks Way (What They Want)</h4>
                    <ul>
                        <li><strong>Ingest√£o:</strong> Lakeflow Connect ou Auto Loader</li>
                        <li><strong>Bronze:</strong> Auto Loader ‚Üí Delta</li>
                        <li><strong>Silver/Gold:</strong> Delta Live Tables (DLT)</li>
                        <li><strong>Orquestra√ß√£o:</strong> Lakeflow Jobs/Workflows</li>
                        <li><strong>Qualidade:</strong> DLT Expectations (built-in)</li>
                    </ul>
                    <p style="color: #2f855a; font-weight: 600;">
                        ‚úÖ Tudo integrado, gerenciado e otimizado
                    </p>
                </div>
            </div>

            <div class="exam-tip">
                <strong>üìù DICA DE PROVA:</strong><br>
                Quando a prova perguntar "qual a melhor abordagem?", escolha SEMPRE a solu√ß√£o nativa do Databricks:<br>
                ‚Ä¢ Ingest√£o ‚Üí Auto Loader ou Lakeflow Connect (nunca mencione ADF!)<br>
                ‚Ä¢ Pipelines ‚Üí Delta Live Tables (n√£o notebooks Python)<br>
                ‚Ä¢ Orquestra√ß√£o ‚Üí Workflows (n√£o Airflow/ADF)<br>
                ‚Ä¢ Qualidade ‚Üí DLT Expectations (n√£o c√≥digo customizado)
            </div>
        </div>

        <!-- DLT Deep Dive -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">üé®</span>
                Delta Live Tables (DLT) - O CORA√á√ÉO do Databricks
            </div>
            
            <div class="truth">
                <h3>‚úÖ O que √© DLT?</h3>
                <p><strong>Delta Live Tables</strong> √© um framework para criar <span class="highlight">pipelines declarativos</span> de dados.</p>
                <p><strong>"Declarativo"</strong> significa: voc√™ diz <strong>O QUE</strong> quer, n√£o <strong>COMO</strong> fazer.</p>
            </div>

            <h4>üîÑ Abordagem Tradicional (Imperativa) vs DLT (Declarativa)</h4>
            
            <div class="comparison-grid">
                <div class="card">
                    <h4>üìù Notebooks Tradicionais (Imperativo)</h4>
                    <pre style="font-size: 11px;">from pyspark.sql.functions import *
from delta.tables import DeltaTable

# Passo 1: Ler dados
df = spark.read.table("bronze.vendas")

# Passo 2: Limpar dados
df_clean = df.filter(col("valor") > 0) \
    .dropDuplicates(["id"]) \
    .withColumn("data", to_date("data_str"))

# Passo 3: Validar qualidade
if df_clean.filter(col("valor").isNull()).count() > 0:
    raise Exception("Dados inv√°lidos!")

# Passo 4: Escrever
df_clean.write.format("delta") \
    .mode("overwrite") \
    .saveAsTable("silver.vendas_clean")

# Passo 5: Criar agrega√ß√£o
df_agg = df_clean.groupBy("produto") \
    .agg(sum("valor").alias("total"))

df_agg.write.format("delta") \
    .mode("overwrite") \
    .saveAsTable("gold.vendas_produto")</pre>
                    <p style="color: #c53030;">‚ùå Voc√™ controla TUDO manualmente:<br>
                    ‚Ä¢ Quando executar<br>
                    ‚Ä¢ Como lidar com erros<br>
                    ‚Ä¢ Depend√™ncias entre tabelas<br>
                    ‚Ä¢ Versionamento<br>
                    ‚Ä¢ Qualidade de dados</p>
                </div>

                <div class="card">
                    <h4>‚ú® Delta Live Tables (Declarativo)</h4>
                    <pre style="font-size: 11px;">import dlt
from pyspark.sql.functions import *

# Bronze: Apenas declara a tabela
@dlt.table(
    comment="Dados brutos de vendas"
)
def vendas_bronze():
    return spark.readStream.table("bronze.vendas")

# Silver: Declara transforma√ß√£o + qualidade
@dlt.table(
    comment="Vendas limpas e validadas"
)
@dlt.expect_or_drop("valor_positivo", "valor > 0")
@dlt.expect_or_fail("sem_nulos", "valor IS NOT NULL")
def vendas_clean():
    return (
        dlt.read("vendas_bronze")
        .dropDuplicates(["id"])
        .withColumn("data", to_date("data_str"))
    )

# Gold: Declara agrega√ß√£o
@dlt.table(
    comment="Total de vendas por produto"
)
def vendas_produto():
    return (
        dlt.read("vendas_clean")
        .groupBy("produto")
        .agg(sum("valor").alias("total"))
    )</pre>
                    <p style="color: #2f855a;">‚úÖ DLT gerencia automaticamente:<br>
                    ‚Ä¢ ‚úÖ Execu√ß√£o e depend√™ncias<br>
                    ‚Ä¢ ‚úÖ Tratamento de erros<br>
                    ‚Ä¢ ‚úÖ Versionamento<br>
                    ‚Ä¢ ‚úÖ Qualidade de dados (Expectations)<br>
                    ‚Ä¢ ‚úÖ Incrementalidade<br>
                    ‚Ä¢ ‚úÖ Lineage (rastreabilidade)</p>
                </div>
            </div>
        </div>

        <!-- Data Quality in DLT -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">‚úÖ</span>
                Qualidade de Dados - DLT Expectations
            </div>
            
            <div class="truth">
                <h3>SIM! Qualidade de Dados est√° no M√≥dulo 1 E ser√° cobrado!</h3>
                <p>DLT tem <strong>Expectations</strong> (expectativas de qualidade) built-in. S√£o como "testes" nos dados.</p>
            </div>

            <h4>üìä 3 Tipos de Expectations:</h4>
            
            <div class="feature-list">
                <div class="feature-item" style="border-left-color: #48bb78;">
                    <h4 style="color: #2f855a; margin-top: 0;">1Ô∏è‚É£ @dlt.expect()</h4>
                    <p><strong>Comportamento:</strong> Registra viola√ß√µes, mas <strong>N√ÉO bloqueia</strong></p>
                    <pre style="font-size: 11px;">@dlt.expect("idade_valida", "idade >= 18")
def clientes():
    return df
# ‚Üë Se idade < 18, registra no log mas insere</pre>
                </div>

                <div class="feature-item" style="border-left-color: #f6ad55;">
                    <h4 style="color: #c05621; margin-top: 0;">2Ô∏è‚É£ @dlt.expect_or_drop()</h4>
                    <p><strong>Comportamento:</strong> <strong>DESCARTA</strong> linhas que violam</p>
                    <pre style="font-size: 11px;">@dlt.expect_or_drop("email_valido", 
                    "email LIKE '%@%'")
def usuarios():
    return df
# ‚Üë Se email inv√°lido, linha √© REMOVIDA</pre>
                </div>

                <div class="feature-item" style="border-left-color: #f56565;">
                    <h4 style="color: #c53030; margin-top: 0;">3Ô∏è‚É£ @dlt.expect_or_fail()</h4>
                    <p><strong>Comportamento:</strong> <strong>FALHA</strong> todo o pipeline</p>
                    <pre style="font-size: 11px;">@dlt.expect_or_fail("id_obrigatorio", 
                    "id IS NOT NULL")
def vendas():
    return df
# ‚Üë Se id = NULL, pipeline PARA completamente</pre>
                </div>
            </div>

            <div class="exam-tip">
                <strong>üéØ PERGUNTA DE PROVA T√çPICA:</strong><br>
                <em>"Voc√™ quer garantir que emails inv√°lidos n√£o sejam inseridos na tabela, mas o pipeline deve continuar. Qual expectation usar?"</em><br><br>
                <strong>Resposta:</strong> <code>@dlt.expect_or_drop()</code> ‚Üí descarta linhas ruins mas continua
            </div>
        </div>

        <!-- SQL vs Python in DLT -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">üî§</span>
                DLT: SQL vs Python (Ambos s√£o v√°lidos!)
            </div>
            
            <div class="comparison-grid">
                <div class="card">
                    <h4>üìò DLT com SQL</h4>
                    <pre style="font-size: 11px;">-- Bronze
CREATE OR REFRESH STREAMING LIVE TABLE vendas_bronze
COMMENT "Dados brutos de vendas"
AS SELECT * FROM cloud_files(
    '/mnt/raw/vendas/', 
    'json'
);

-- Silver com qualidade
CREATE OR REFRESH LIVE TABLE vendas_clean (
  CONSTRAINT valor_positivo 
    EXPECT (valor > 0) ON VIOLATION DROP ROW,
  CONSTRAINT id_obrigatorio 
    EXPECT (id IS NOT NULL) ON VIOLATION FAIL
)
COMMENT "Vendas validadas"
AS SELECT 
    id,
    produto,
    valor,
    to_date(data_str) as data
FROM LIVE.vendas_bronze;

-- Gold
CREATE OR REFRESH LIVE TABLE vendas_produto
AS SELECT 
    produto,
    SUM(valor) as total
FROM LIVE.vendas_clean
GROUP BY produto;</pre>
                    <p style="color: #2c5282;">‚úÖ <strong>Mais simples</strong> para analistas SQL<br>
                    ‚úÖ Foco do Databricks na certifica√ß√£o</p>
                </div>

                <div class="card">
                    <h4>üêç DLT com Python</h4>
                    <pre style="font-size: 11px;">import dlt
from pyspark.sql.functions import *

# Bronze
@dlt.table(comment="Dados brutos")
def vendas_bronze():
    return (spark.readStream
        .format("cloudFiles")
        .option("cloudFiles.format", "json")
        .load('/mnt/raw/vendas/'))

# Silver
@dlt.table(comment="Vendas validadas")
@dlt.expect_or_drop("valor_positivo", 
                    "valor > 0")
@dlt.expect_or_fail("id_obrigatorio", 
                    "id IS NOT NULL")
def vendas_clean():
    return (dlt.read("vendas_bronze")
        .withColumn("data", 
                   to_date("data_str")))

# Gold
@dlt.table
def vendas_produto():
    return (dlt.read("vendas_clean")
        .groupBy("produto")
        .agg(sum("valor").alias("total")))</pre>
                    <p style="color: #2c5282;">‚úÖ <strong>Mais flex√≠vel</strong> para l√≥gicas complexas<br>
                    ‚úÖ Melhor para engenheiros Python</p>
                </div>
            </div>

            <div class="warning">
                <strong>‚ö†Ô∏è Para a prova:</strong> Databricks est√° promovendo <strong>SQL</strong> como linguagem principal para DLT. Se a pergunta for amb√≠gua, escolha SQL!
            </div>
        </div>

        <!-- When to Use What -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">ü§î</span>
                Quando Usar Cada Abordagem? (Vis√£o Realista)
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>Cen√°rio</th>
                        <th>Mundo Real</th>
                        <th>O que Databricks Quer (Prova)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Ingest√£o de arquivos</strong></td>
                        <td>ADF, Fivetran, scripts</td>
                        <td><strong>Auto Loader ou Lakeflow Connect</strong></td>
                    </tr>
                    <tr>
                        <td><strong>Pipelines simples (filtros, joins)</strong></td>
                        <td>Notebooks Python ou ADF</td>
                        <td><strong>Delta Live Tables (SQL)</strong></td>
                    </tr>
                    <tr>
                        <td><strong>L√≥gica de neg√≥cio complexa</strong></td>
                        <td>Notebooks Python com PySpark</td>
                        <td><strong>DLT Python</strong> (mas prefere SQL quando poss√≠vel)</td>
                    </tr>
                    <tr>
                        <td><strong>Orquestra√ß√£o</strong></td>
                        <td>Airflow, ADF</td>
                        <td><strong>Databricks Workflows</strong></td>
                    </tr>
                    <tr>
                        <td><strong>Qualidade de dados</strong></td>
                        <td>Great Expectations, c√≥digo custom</td>
                        <td><strong>DLT Expectations</strong></td>
                    </tr>
                    <tr>
                        <td><strong>Governan√ßa</strong></td>
                        <td>Purview, Collibra, scripts</td>
                        <td><strong>Unity Catalog</strong></td>
                    </tr>
                </tbody>
            </table>

            <div class="exam-tip">
                <strong>üéØ REGRA DE OURO PARA A PROVA:</strong><br>
                Se a pergunta diz "qual √© a melhor pr√°tica no Databricks?" ‚Üí escolha SEMPRE a ferramenta nativa deles, mesmo que no mundo real voc√™ usaria outra coisa!
            </div>
        </div>

        <!-- Your Complex Logic -->
        <div class="section">
            <div class="section-title">
                <span style="font-size: 28px;">üß©</span>
                "Mas minhas l√≥gicas de neg√≥cio s√£o complexas!"
            </div>
            
            <div class="truth">
                <h3>‚úÖ Voc√™ pode usar DLT mesmo com l√≥gica complexa!</h3>
                <p>DLT Python permite:</p>
                <ul>
                    <li>‚úÖ UDFs (User Defined Functions)</li>
                    <li>‚úÖ L√≥gicas complexas de transforma√ß√£o</li>
                    <li>‚úÖ ML inference</li>
                    <li>‚úÖ Integra√ß√£o com bibliotecas Python</li>
                    <li>‚úÖ Window functions complexas</li>
                </ul>
            </div>

            <h4>Exemplo: L√≥gica Complexa em DLT</h4>
            <pre>import dlt
from pyspark.sql.functions import *
from pyspark.sql.window import Window

@dlt.table(comment="Clientes com score complexo")
@dlt.expect_or_drop("score_valido", "score_risco >= 0 AND score_risco <= 100")
def clientes_com_score():
    # L√≥gica complexa de neg√≥cio
    def calcular_score_risco(idade, renda, historico):
        # Sua f√≥rmula propriet√°ria complexa aqui
        peso_idade = idade * 0.3
        peso_renda = (100000 - renda) / 1000 * 0.5
        peso_historico = historico * 0.2
        return peso_idade + peso_renda + peso_historico
    
    # Registra UDF
    udf_score = udf(calcular_score_risco, FloatType())
    
    # Window function para ranking
    window_spec = Window.partitionBy("cidade").orderBy(desc("renda"))
    
    return (
        dlt.read("clientes_bronze")
        .withColumn("score_risco", 
                   udf_score(col("idade"), col("renda"), col("historico_pagto")))
        .withColumn("rank_cidade", rank().over(window_spec))
        .filter(col("score_risco") < 70)  # Filtro de neg√≥cio
    )

# Voc√™ ainda tem todo o poder do PySpark!
# Mas com os benef√≠cios do DLT (qualidade, lineage, etc)</pre>

            <div class="warning">
                <strong>üí° Mensagem do Databricks:</strong><br>
                "N√£o √© notebooks Python <strong>vs</strong> DLT. √â notebooks Python <strong>dentro</strong> do DLT!"<br>
                DLT √© o framework que orquestra tudo, mas voc√™ pode escrever Python complexo dentro dele.
            </div>
        </div>

        <!-- Summary -->
        <div class="section" style="background: #2d3748; color: white; border: none;">
            <div class="section-title" style="color: white;">
                <span style="font-size: 28px;">üìù</span>
                Resumo: O que focar para a prova
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px;">
                    <h4 style="color: #68d391; margin-top: 0;">‚úÖ O que est√° NA PROVA</h4>
                    <ul style="line-height: 2;">
                        <li><strong>Auto Loader</strong> - ingest√£o streaming</li>
                        <li><strong>COPY INTO</strong> - ingest√£o batch</li>
                        <li><strong>Delta Live Tables (DLT)</strong> - pipelines declarativos</li>
                        <li><strong>DLT Expectations</strong> - qualidade de dados</li>
                        <li><strong>Unity Catalog</strong> - governan√ßa</li>
                        <li><strong>Workflows/Jobs</strong> - orquestra√ß√£o</li>
                        <li><strong>Volumes</strong> - file storage</li>
                        <li><strong>Delta Lake</strong> - formato de tabela</li>
                    </ul>
                </div>

                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px;">
                    <h4 style="color: #fc8181; margin-top: 0;">‚ùå O que N√ÉO est√° na prova</h4>
                    <ul style="line-height: 2;">
                        <li>Azure Data Factory (ADF)</li>
                        <li>Airflow</li>
                        <li>Fivetran</li>
                        <li>Great Expectations</li>
                        <li>dbt (mencionam, mas n√£o focam)</li>
                        <li>Notebooks tradicionais (preferem DLT)</li>
                    </ul>
                </div>
            </div>

            <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 10px; margin-top: 20px;">
                <h4 style="color: #fbd38d; margin-top: 0;">üéØ Estrat√©gia para passar:</h4>
                <ol style="line-height: 2; font-size: 16px;">
                    <li><strong>Pense "Databricks-first":</strong> sempre escolha ferramentas nativas</li>
                    <li><strong>DLT √© o rei:</strong> se perguntarem sobre pipelines ‚Üí responda DLT</li>
                    <li><strong>SQL > Python:</strong> quando ambos forem v√°lidos, escolha SQL</li>
                    <li><strong>Qualidade = Expectations:</strong> n√£o mencione c√≥digo customizado</li>
                    <li><strong>CTAS √© transforma√ß√£o:</strong> n√£o √© ingest√£o!</li>
                    <li><strong>Auto Loader > COPY INTO:</strong> para streaming e escala</li>
                </ol>
            </div>
        </div>

        <!-- Final Tips -->
        <div class="exam-tip" style="margin-top: 30px; font-size: 16px;">
            <strong>üöÄ DICA FINAL:</strong><br><br>
            <strong>M√≥dulo 1 (Lakeflow Connect)</strong> = Ingest√£o com qualidade b√°sica<br>
            <strong>M√≥dulo 2 (Lakeflow Jobs)</strong> = Orquestra√ß√£o<br>
            <strong>M√≥dulo 3 (DLT)</strong> = Pipelines + Qualidade avan√ßada<br>
            <strong>M√≥dulo 4 (Unity Catalog)</strong> = Governan√ßa<br><br>
            
            <strong style="color: #c53030;">Qualidade de dados aparece em TODOS os m√≥dulos, mas √© aprofundada no M√≥dulo 3 (DLT)!</strong>
        </div>
    </div>
</body>
</html>
